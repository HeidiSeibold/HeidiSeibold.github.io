
## Overview

## Use

From the root directory of the Jekyll project repository, 
use the volumes option, `-v` to link the current working 
directory to the `/data` directory on the container:

```
docker run --rm -i -v $(pwd):/data cboettig/labnotebook \
  Rscript -e 'servr::jekyll(serve=FALSE, host="0.0.0.0", port=4000, script="build.R")'
```

This will run the call to `servr::jekyll` to run the R code and build
the Jekyll site according to the configuration.

The Docker container includes only general-purpose software required
to build the site (R and Ruby), all the site content, layout etc is
not included in the container. As such, this container also works as
a general-purpose swiss-army knife; simply provide the desired
command to override the default. For example:

An R shell:

```
docker run --rm -i -v $(pwd):/data cboettig/labnotebook R 
```

Pandoc: 

```
docker run --rm -i -v $(pwd):/data cboettig/labnotebook pandoc
```

jekyll server: 

```
docker run -d -p 4000:4000 -v $(pwd):/data cboettig/labnotebook jekyll serve -H 0.0.0.0
```


bash: 

```
docker run --rm -i -v $(pwd):/data cboettig/labnotebook bash 
```

latex: 

```
docker run --rm -i -v $(pwd):/data cboettig/labnotebook pdflatex file.tex 
```


RStudio server (note the `-u 0` to launch server as root): 

```
docker run -d -p 8787:8787 -u 0 -v $(pwd):/data cboettig/labnotebook supervisord
```



## Configuration

### R 

See [build.R](https://github.com/cboettig/cboettig.github.io/blob/source/_build/build.R)

### Jekyll

See [_config.yml](https://github.com/cboettig/cboettig.github.io/blob/source/_config.yml) in the root directory. 

### Drone

See the [.drone.yml](https://github.com/cboettig/cboettig.github.io/blob/source/.drone.yml) file in the root directory, and the [drone.yml documentation]()

## Interactive use 

For interactive use in RStudio, link to the home directory instead:



## Files 

- [Dockerfile](https://github.com/cboettig/cboettig.github.io/blob/source/_build/Dockerfile): Builds on the general-purpose [rocker/hadleyverse](https://registry.hub.docker.com/u/rocker/hadleyverse/) container, which provides many of the basic R dependencies including pandoc. Adds additional R packages and the necessary Ruby environment for Jekyll. 
- [Gemfile](https://github.com/cboettig/cboettig.github.io/blob/source/_build/Gemfile): Used by the Dockerfile. A list of gems installed on the docker image.
- [Gemfile.lock](https://github.com/cboettig/cboettig.github.io/blob/source/_build/Gemfile.lock): Used by the Dockerfile. Automatically generated by Bundler using the docker image, thereafter used to lock versions of gems
- [build.R](https://github.com/cboettig/cboettig.github.io/blob/source/_build/build.R):
- [deploy.sh](https://github.com/cboettig/cboettig.github.io/blob/source/_build/deploy.sh): A script used by [drone.yml](https://github.com/cboettig/cboettig.github.io/blob/source/.drone.yml) to deploy the built site to Github appropriately. This must be configured to use the appropriate branches depending on whether a project repository or a user/org repository (`username.github.io`) is being used. Project repositories host the HTML from `gh-pages` branch, user repositories host from `master` the master branch.  

